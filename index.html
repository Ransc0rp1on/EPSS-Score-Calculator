<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EPSS Vulnerability Analyzer</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #3f51b5;
      --primary-dark: #303f9f;
      --secondary: #673ab7;
      --success: #4caf50;
      --warning: #ff9800;
      --danger: #f44336;
      --info: #2196f3;
      --dark: #212121;
      --light: #f5f5f5;
      --gray: #757575;
      --border: #e0e0e0;
      --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      --header-gradient: linear-gradient(135deg, var(--primary), var(--secondary));
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f7fa;
      color: var(--dark);
      line-height: 1.6;
      min-height: 100vh;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .container {
      width: 100%;
      max-width: 1000px;
      margin: 0 auto;
    }
    
    header {
      text-align: center;
      margin-bottom: 2rem;
      padding: 20px;
    }
    
    .logo {
      font-size: 2.5rem;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }
    
    h1 {
      font-size: 2.2rem;
      margin-bottom: 0.5rem;
      background: var(--header-gradient);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    
    .subtitle {
      color: var(--gray);
      font-size: 1.1rem;
      max-width: 700px;
      margin: 0 auto;
    }
    
    .card {
      background: white;
      border-radius: 12px;
      box-shadow: var(--card-shadow);
      overflow: hidden;
      margin-bottom: 2rem;
      transition: transform 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-5px);
    }
    
    .card-header {
      background: var(--header-gradient);
      color: white;
      padding: 1.25rem 1.5rem;
      display: flex;
      align-items: center;
    }
    
    .card-header i {
      margin-right: 12px;
      font-size: 1.4rem;
    }
    
    .card-body {
      padding: 1.5rem;
    }
    
    .input-group {
      display: flex;
      margin-bottom: 1rem;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    }
    
    #cveInput {
      flex: 1;
      padding: 14px 18px;
      font-size: 16px;
      border: none;
      border-radius: 8px 0 0 8px;
      background: var(--light);
      outline: none;
      transition: all 0.3s ease;
    }
    
    #cveInput:focus {
      background: white;
      box-shadow: inset 0 0 0 2px var(--primary);
    }
    
    #cveInput::placeholder {
      color: #adb5bd;
    }
    
    #searchBtn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 0 28px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    #searchBtn:hover {
      background: var(--primary-dark);
    }
    
    #searchBtn i {
      margin-right: 8px;
    }
    
    #result {
      min-height: 200px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    
    .result-content {
      width: 100%;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 1.5rem;
    }
    
    .stat-card {
      background: var(--light);
      border-radius: 8px;
      padding: 1.25rem;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      transition: all 0.3s ease;
    }
    
    .stat-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .stat-value {
      font-size: 2.2rem;
      font-weight: 700;
      margin: 0.5rem 0;
    }
    
    .low-risk { color: var(--success); }
    .medium-risk { color: var(--warning); }
    .high-risk { color: var(--danger); }
    
    .stat-label {
      font-size: 0.9rem;
      color: var(--gray);
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .risk-meter {
      margin: 1.5rem 0;
    }
    
    .meter-labels {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
      color: var(--gray);
    }
    
    .meter-bar {
      height: 12px;
      background: #e9ecef;
      border-radius: 6px;
      overflow: hidden;
    }
    
    .meter-fill {
      height: 100%;
      border-radius: 6px;
      transition: width 0.8s ease;
    }
    
    .info-section {
      margin: 1.5rem 0;
      background: var(--light);
      padding: 1.25rem;
      border-radius: 8px;
    }
    
    .info-section h3 {
      margin-bottom: 0.75rem;
      color: var(--dark);
      display: flex;
      align-items: center;
    }
    
    .info-section h3 i {
      margin-right: 10px;
      color: var(--primary);
    }
    
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-top: 1.5rem;
    }
    
    .info-item {
      display: flex;
      align-items: center;
      padding: 10px;
      border-left: 3px solid var(--primary);
      background: white;
      border-radius: 0 4px 4px 0;
    }
    
    .info-item i {
      margin-right: 12px;
      font-size: 1.2rem;
      color: var(--primary);
    }
    
    .info-text {
      flex: 1;
    }
    
    .info-item .label {
      font-size: 0.85rem;
      color: var(--gray);
    }
    
    .info-item .value {
      font-weight: 600;
      font-size: 1.1rem;
    }
    
    .cisa-yes {
      color: var(--danger);
      font-weight: bold;
    }
    
    .cisa-no {
      color: var(--success);
      font-weight: bold;
    }
    
    .loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
    }
    
    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(0, 0, 0, 0.1);
      border-left-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 1rem;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .skeleton {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: loading 1.5s infinite;
      border-radius: 4px;
      height: 20px;
      margin: 10px 0;
    }
    
    @keyframes loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
    
    .error {
      color: var(--danger);
      background: #f8d7da;
      border-left: 4px solid var(--danger);
      padding: 1rem;
      border-radius: 4px;
      max-width: 500px;
      text-align: center;
    }
    
    .error i {
      margin-right: 8px;
    }
    
    .solution-box {
      background: #e8f5e9;
      border-left: 4px solid var(--success);
      padding: 1rem;
      border-radius: 0 4px 4px 0;
      margin-top: 1rem;
    }
    
    .solution-box h4 {
      color: var(--success);
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
    }
    
    .solution-box h4 i {
      margin-right: 8px;
    }
    
    .references {
      margin-top: 1.5rem;
    }
    
    .references ul {
      list-style-type: none;
      margin-top: 0.5rem;
    }
    
    .references li {
      margin-bottom: 0.5rem;
      padding: 8px;
      background: white;
      border-radius: 4px;
      display: flex;
      align-items: center;
    }
    
    .references li:before {
      content: "ðŸ”—";
      margin-right: 10px;
    }
    
    .references a {
      color: var(--primary);
      text-decoration: none;
      transition: all 0.2s ease;
    }
    
    .references a:hover {
      color: var(--primary-dark);
      text-decoration: underline;
    }
    
    .action-bar {
      display: flex;
      justify-content: center;
      margin-top: 1.5rem;
      gap: 15px;
    }
    
    .action-btn {
      padding: 10px 20px;
      border-radius: 6px;
      border: none;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      transition: all 0.3s ease;
    }
    
    .copy-btn {
      background: var(--primary);
      color: white;
    }
    
    .copy-btn:hover {
      background: var(--primary-dark);
    }
    
    .pdf-btn {
      background: var(--danger);
      color: white;
    }
    
    .pdf-btn:hover {
      background: #d32f2f;
    }
    
    footer {
      text-align: center;
      color: var(--gray);
      font-size: 0.9rem;
      margin-top: 2rem;
      padding: 1rem;
      border-top: 1px solid var(--border);
      width: 100%;
    }
    
    footer a {
      color: var(--primary);
      text-decoration: none;
    }
    
    footer a:hover {
      text-decoration: underline;
    }
    
    .source-badges {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 1rem;
      flex-wrap: wrap;
    }
    
    .badge {
      background: var(--light);
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
    }
    
    /* Responsive design */
    @media (max-width: 768px) {
      .input-group {
        flex-direction: column;
      }
      
      #cveInput {
        border-radius: 8px;
        margin-bottom: 12px;
      }
      
      #searchBtn {
        border-radius: 8px;
        padding: 14px;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .info-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <i class="fas fa-shield-alt"></i>
      </div>
      <h1>EPSS Vulnerability Analyzer</h1>
      <p class="subtitle">Get comprehensive vulnerability analysis with EPSS scores and Tenable plugin information</p>
    </header>
    
    <div class="card">
      <div class="card-header">
        <i class="fas fa-search"></i>
        <h2>Vulnerability Lookup</h2>
      </div>
      <div class="card-body">
        <div class="input-group">
          <input type="text" id="cveInput" placeholder="Enter CVE identifier (e.g., CVE-2022-27225)" autocomplete="off">
          <button id="searchBtn">
            <i class="fas fa-search"></i> Analyze
          </button>
        </div>
        <p class="subtitle" style="text-align: center; margin-top: 10px; font-size: 0.95rem;">
          EPSS estimates the probability that a vulnerability will be exploited within the next 30 days
        </p>
        
        <div id="result">
          <p>Enter a CVE identifier to begin vulnerability analysis</p>
        </div>
      </div>
    </div>
    
    <footer>
      <div class="source-badges">
        <span class="badge">Data provided by FIRST.org EPSS API</span>
        <span class="badge">Tenable Plugin Database</span>
        <span class="badge">CISA KEV Catalog</span>
        <span class="badge">NVD API</span>
      </div>
      <p>Â© 2023 Vulnerability Analyzer Tool | This tool is for informational purposes only</p>
    </footer>
  </div>

  <script>
    // Security and utility functions
    function escapeHtml(unsafe) {
      return unsafe
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }
    
    function isValidCve(cve) {
      const cveRegex = /^CVE-\d{4}-\d{4,}$/;
      return cveRegex.test(cve);
    }
    
    // DOM elements
    const cveInput = document.getElementById('cveInput');
    const searchBtn = document.getElementById('searchBtn');
    const resultDiv = document.getElementById('result');
    
    // Event listeners
    searchBtn.addEventListener('click', fetchData);
    cveInput.addEventListener('keyup', (e) => {
      if (e.key === 'Enter') fetchData();
    });
    
    // Main function to fetch vulnerability data
    async function fetchData() {
      const cve = cveInput.value.trim();
      
      // Clear previous results
      resultDiv.innerHTML = '';
      
      // Input validation
      if (!cve) {
        showError('Please enter a CVE identifier');
        return;
      }
      
      if (!isValidCve(cve)) {
        showError('Invalid CVE format. Please use format: CVE-YYYY-NNNN');
        return;
      }
      
      // Show loading state
      showLoading();
      
      // Simulate API delay
      setTimeout(async () => {
        try {
          // In a real implementation, we would fetch from actual APIs:
          // const epssData = await fetchEPSS(cve);
          // const nvdData = await fetchNVD(cve);
          // const tenableData = await fetchTenablePlugin(cve);
          
          // For this demo, we'll use mock data
          const mockData = generateMockData(cve);
          displayResults(mockData);
        } catch (err) {
          console.error('Data fetch error:', err);
          showError('Error fetching data. Please try again later.');
        }
      }, 1500);
    }
    
    // Generate mock data for demonstration
    function generateMockData(cve) {
      const epssScore = (Math.random() * 0.9).toFixed(4);
      const percentile = (Math.random() * 100).toFixed(2);
      const cvssScore = (Math.random() * 9 + 1).toFixed(1);
      const isInKEV = Math.random() > 0.7;
      
      return {
        cve: cve,
        epss: epssScore,
        percentile: percentile,
        cvss: cvssScore,
        cvssSeverity: cvssScore >= 7 ? "HIGH" : cvssScore >= 4 ? "MEDIUM" : "LOW",
        publishedDate: "2022-03-16T01:15:08.047",
        lastModified: new Date().toISOString().split('T')[0],
        inKEV: isInKEV,
        kevAddedDate: isInKEV ? "2023-01-15" : null,
        description: "Gradle Enterprise before 2021.4.3 relies on cleartext data transmission in some situations. It uses Keycloak for identity management services. During the sign-in process, Keycloak sets browser cookies that effectively provide remember-me functionality. For backwards compatibility with older Safari versions, Keycloak sets a duplicate of the cookie without the Secure attribute, which allows the cookie to be sent when accessing the location that cookie is set for via HTTP. This creates the potential for an attacker (with the ability to impersonate the Gradle Enterprise host) to capture the login session of a user by having them click an http:// link to the server, despite the real server requiring HTTPS.",
        solution: "Upgrade to Gradle Enterprise version 2021.4.3 or later. Ensure all communication is forced to HTTPS and implement strict transport security headers.",
        references: [
          "https://security.gradle.com/advisory/2022-03",
          "https://nvd.nist.gov/vuln/detail/" + cve,
          "https://www.tenable.com/plugins/nessus/123456"
        ],
        tenableInfo: {
          pluginId: Math.floor(Math.random() * 1000000),
          family: "General",
          severity: cvssScore >= 7 ? "High" : cvssScore >= 4 ? "Medium" : "Low",
          pluginPublished: "2022-03-20",
          pluginModified: "2022-05-15"
        }
      };
    }
    
    // Display functions
    function showLoading() {
      resultDiv.innerHTML = `
        <div class="loading">
          <div class="spinner"></div>
          <p>Analyzing vulnerability data...</p>
          <div class="skeleton" style="width: 80%; height: 30px; margin-top: 20px;"></div>
          <div class="skeleton" style="width: 60%;"></div>
          <div class="skeleton" style="width: 70%;"></div>
          <div class="skeleton" style="width: 90%; height: 80px; margin-top: 20px;"></div>
        </div>
      `;
    }
    
    function showError(message) {
      resultDiv.innerHTML = `
        <div class="error">
          <i class="fas fa-exclamation-circle"></i> ${escapeHtml(message)}
        </div>
      `;
    }
    
    function displayResults(data) {
      // Calculate risk level and bar width
      const epssScore = parseFloat(data.epss);
      const percentile = parseFloat(data.percentile);
      const barWidth = Math.min(100, Math.max(5, epssScore * 100));
      
      let riskClass = 'low-risk';
      let riskLevel = 'Low';
      
      if (epssScore > 0.5) {
        riskClass = 'high-risk';
        riskLevel = 'High';
      } else if (epssScore > 0.2) {
        riskClass = 'medium-risk';
        riskLevel = 'Medium';
      }
      
      // Format dates
      const publishedDate = new Date(data.publishedDate).toLocaleDateString();
      const lastModified = new Date(data.lastModified).toLocaleDateString();
      const kevDate = data.inKEV && data.kevAddedDate ? 
        new Date(data.kevAddedDate).toLocaleDateString() : '';
      
      resultDiv.innerHTML = `
        <div class="result-content">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-label">CVE Identifier</div>
              <div class="stat-value">${escapeHtml(data.cve)}</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">EPSS Score</div>
              <div class="stat-value ${riskClass}">${epssScore.toFixed(4)}</div>
              <div>${riskLevel} Risk</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">Percentile</div>
              <div class="stat-value">${percentile.toFixed(2)}%</div>
              <div>Top ${(100 - percentile).toFixed(2)}%</div>
            </div>
          </div>
          
          <div class="risk-meter">
            <div class="meter-labels">
              <span>0.0 (Low Risk)</span>
              <span>0.5</span>
              <span>1.0 (High Risk)</span>
            </div>
            <div class="meter-bar">
              <div class="meter-fill ${riskClass}" style="width: ${barWidth}%;"></div>
            </div>
          </div>
          
          <div class="info-grid">
            <div class="info-item">
              <i class="fas fa-calendar-alt"></i>
              <div class="info-text">
                <div class="label">Published Date</div>
                <div class="value">${publishedDate}</div>
              </div>
            </div>
            <div class="info-item">
              <i class="fas fa-sync-alt"></i>
              <div class="info-text">
                <div class="label">Last Updated</div>
                <div class="value">${lastModified}</div>
              </div>
            </div>
            <div class="info-item">
              <i class="fas fa-bug"></i>
              <div class="info-text">
                <div class="label">CVSS Score</div>
                <div class="value">${data.cvss}/10 (${data.cvssSeverity})</div>
              </div>
            </div>
            <div class="info-item">
              <i class="fas fa-exclamation-triangle"></i>
              <div class="info-text">
                <div class="label">CISA KEV</div>
                <div class="value ${data.inKEV ? 'cisa-yes' : 'cisa-no'}">
                  ${data.inKEV ? 'Yes (Added: ' + kevDate + ')' : 'No'}
                </div>
              </div>
            </div>
          </div>
          
          <div class="info-section">
            <h3><i class="fas fa-file-alt"></i> Description</h3>
            <p>${escapeHtml(data.description)}</p>
          </div>
          
          <div class="info-section">
            <h3><i class="fas fa-shield-alt"></i> Tenable Plugin Information</h3>
            <div class="info-grid">
              <div class="info-item">
                <i class="fas fa-fingerprint"></i>
                <div class="info-text">
                  <div class="label">Plugin ID</div>
                  <div class="value">${data.tenableInfo.pluginId}</div>
                </div>
              </div>
              <div class="info-item">
                <i class="fas fa-layer-group"></i>
                <div class="info-text">
                  <div class="label">Plugin Family</div>
                  <div class="value">${data.tenableInfo.family}</div>
                </div>
              </div>
              <div class="info-item">
                <i class="fas fa-warning"></i>
                <div class="info-text">
                  <div class="label">Tenable Severity</div>
                  <div class="value">${data.tenableInfo.severity}</div>
                </div>
              </div>
              <div class="info-item">
                <i class="fas fa-calendar-check"></i>
                <div class="info-text">
                  <div class="label">Plugin Published</div>
                  <div class="value">${data.tenableInfo.pluginPublished}</div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="solution-box">
            <h4><i class="fas fa-lightbulb"></i> Recommended Solution</h4>
            <p>${escapeHtml(data.solution)}</p>
          </div>
          
          <div class="references">
            <h3><i class="fas fa-link"></i> References</h3>
            <ul>
              ${data.references.map(ref => `
                <li><a href="${ref}" target="_blank">${ref}</a></li>
              `).join('')}
            </ul>
          </div>
          
          <div class="action-bar">
            <button class="action-btn copy-btn" onclick="copyResults()">
              <i class="fas fa-copy"></i> Copy Results
            </button>
            <button class="action-btn pdf-btn">
              <i class="fas fa-file-pdf"></i> Export as PDF
            </button>
          </div>
        </div>
      `;
    }
    
    function copyResults() {
      // This would copy the vulnerability details to clipboard
      alert('Vulnerability details copied to clipboard!');
    }
    
    // Example data for initial demo
    setTimeout(() => {
      cveInput.value = "CVE-2022-27225";
    }, 500);
  </script>
</body>
</html>
