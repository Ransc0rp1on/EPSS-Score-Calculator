<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>EPSS CVE Lookup</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
    h1 { color: #333; }
    input { padding: 8px; font-size: 14px; width: 250px; }
    button { padding: 8px 12px; font-size: 14px; cursor: pointer; }
    #result { margin-top: 20px; padding: 15px; background: #fff; border-radius: 5px; }
    .error { color: red; }
  </style>
</head>
<body>

<h1>EPSS CVE Lookup</h1>
<p>Enter a CVE ID (e.g. CVE-2022-27225):</p>

<input type="text" id="cveInput" placeholder="CVE-YYYY-NNNN">
<button onclick="fetchEPSS()">Search</button>

<div id="result"></div>

<script>
async function fetchEPSS() {
  const cve = document.getElementById("cveInput").value.trim();
  const resultDiv = document.getElementById("result");
  resultDiv.innerHTML = "";

  if (!cve) {
    resultDiv.innerHTML = "<p class='error'>Please enter a CVE ID.</p>";
    return;
  }

  try {
    const apiUrl = `https://api.first.org/data/v1/epss?cve=${encodeURIComponent(cve)}`;
    const res = await fetch(apiUrl);
    const data = await res.json();

    if (data && data.data && Object.keys(data.data).length > 0) {
      const epssInfo = Object.values(data.data)[0];
      resultDiv.innerHTML = `
        <strong>CVE:</strong> ${epssInfo.cve}<br>
        <strong>EPSS Score:</strong> ${epssInfo.epss}<br>
        <strong>Percentile:</strong> ${epssInfo.percentile}
      `;
    } else {
      resultDiv.innerHTML = "<p class='error'>CVE not found.</p>";
    }
  } catch (err) {
    console.error(err);
    resultDiv.innerHTML = "<p class='error'>Error fetching data.</p>";
  }
}
</script>

</body>
</html>
